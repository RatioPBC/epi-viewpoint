#!/usr/bin/env bash

# Stops postgres using pg_ctl.
#
# Pass '-q' option if you don't want it to complain when it thinks postgres is not running.

source "bin/_support/cecho.sh"

set -e

if ps -x -o command | grep '[/]bin/postgres -D'; then
  cecho --yellow "${0}:" --green "Stopping postgres..."
  eval "$(ps -x -o command | grep '[/]bin/postgres -D' | sed 's/bin\/postgres/bin\/pg_ctl/') stop"
else
  if [[ $1 != "-q" ]]; then
    cecho --yellow "${0}:" --red "Postgres does not seem to be running"
    exit 1
  fi
fi
